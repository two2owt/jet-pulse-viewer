<!doctype html>
<html lang="en" style="min-height: 100%; background-color: #ffffff;">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <!-- Critical CSS - set a boot theme before app CSS loads to avoid flash -->
    <style id="critical-theme">
      :root {
        --boot-bg: #ffffff;
        --boot-fg: #0b0b0c;
        color-scheme: light;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --boot-bg: #0f0f0f;
          --boot-fg: #fafafa;
          color-scheme: dark;
        }
        html { background-color: #0f0f0f !important; }
      }
      /* Ensure all container elements have explicit backgrounds */
      html, body, #root, main, .app-wrapper {
        background-color: var(--boot-bg) !important;
        color: var(--boot-fg);
        margin: 0;
        padding: 0;
        min-height: 100%;
      }
      /* Mobile Safari fix - ensure no transparent backgrounds */
      body {
        background: var(--boot-bg) !important;
      }
      * { box-sizing: border-box; }

      /* Font-face fallback with metric adjustments to match Kanit and prevent CLS */
      @font-face {
        font-family: 'Kanit Fallback';
        src: local('system-ui'), local('-apple-system'), local('BlinkMacSystemFont'), local('Segoe UI'), local('Arial');
        /* Metric adjustments to match Kanit - prevents layout shift on font swap */
        ascent-override: 103%;
        descent-override: 32%;
        line-gap-override: 0%;
        size-adjust: 97%;
      }

      body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        /* Use Kanit with metric-adjusted fallback to prevent CLS */
        font-family: 'Kanit', 'Kanit Fallback', system-ui, -apple-system, sans-serif;
      }
    </style>
    <!-- PWA Meta Tags - theme color matches system preference -->
    <meta name="theme-color" content="#fafafa" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#0f0f0f" media="(prefers-color-scheme: dark)" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="JET" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="manifest" href="/manifest.webmanifest" />
    
    <!-- Resource hints for performance - prioritized by critical path -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Supabase API preconnect for faster data fetching -->
    <link rel="preconnect" href="https://zbrscuoqmkdbmdimdnqu.supabase.co" crossorigin>
    <!-- Mapbox preconnects for map rendering -->
    <link rel="preconnect" href="https://api.mapbox.com" crossorigin>
    <link rel="preconnect" href="https://tiles.mapbox.com" crossorigin>
    <link rel="preconnect" href="https://events.mapbox.com" crossorigin>
    <!-- DNS prefetch for less critical resources -->
    <link rel="dns-prefetch" href="https://api.mixpanel.com">
    
    <!-- Preload critical font files for faster text rendering - all weights used -->
    <link rel="preload" href="https://fonts.gstatic.com/s/kanit/v15/nKKZ-Go6G5tXcraBGwCKd6xBDFs.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://fonts.gstatic.com/s/kanit/v15/nKKU-Go6G5tXcr5mOBWzVaF5NQ.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://fonts.gstatic.com/s/kanit/v15/nKKU-Go6G5tXcr5aOhWzVaF5NQ.woff2" as="font" type="font/woff2" crossorigin>
    
    <!-- Supabase API preconnect - all subdomains for auth, REST, realtime, storage -->
    <link rel="preconnect" href="https://zbrscuoqmkdbmdimdnqu.supabase.co" crossorigin>
    <link rel="dns-prefetch" href="https://zbrscuoqmkdbmdimdnqu.supabase.co">
    <!-- Supabase realtime for live updates -->
    <link rel="preconnect" href="wss://zbrscuoqmkdbmdimdnqu.supabase.co" crossorigin>
    <!-- Supabase storage for images -->
    <link rel="dns-prefetch" href="https://zbrscuoqmkdbmdimdnqu.supabase.co/storage">
    
    <!-- Google Cloud Storage for uploaded images -->
    <link rel="preconnect" href="https://storage.googleapis.com" crossorigin>
    <link rel="dns-prefetch" href="https://storage.googleapis.com">
    
    <!-- Mapbox preconnect hints - prioritized for map rendering -->
    <link rel="preconnect" href="https://api.mapbox.com" crossorigin>
    <link rel="preconnect" href="https://events.mapbox.com" crossorigin>
    <link rel="dns-prefetch" href="https://api.mapbox.com">
    <link rel="dns-prefetch" href="https://tiles.mapbox.com">
    <link rel="dns-prefetch" href="https://events.mapbox.com">
    <!-- Mapbox tile sources -->
    <link rel="dns-prefetch" href="https://a.tiles.mapbox.com">
    <link rel="dns-prefetch" href="https://b.tiles.mapbox.com">
    
    <!-- Early API prefetch script - starts critical data fetch before React hydrates -->
    <script>
      // Prefetch critical API endpoints to warm up connections and cache
      (function() {
        const SUPABASE_URL = 'https://zbrscuoqmkdbmdimdnqu.supabase.co';
        const ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpicnNjdW9xbWtkYm1kaW1kbnF1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMDkwODgsImV4cCI6MjA3ODc4NTA4OH0.LtDrHXcgQF4OrNVpKYXNTX9fdvTsscaMy35jK77qk2c';
        
        // Store prefetched data for React to use
        window.__PREFETCHED_DATA__ = {};
        
        // Prefetch active deals (critical for initial render)
        fetch(SUPABASE_URL + '/rest/v1/deals?active=eq.true&select=*&order=created_at.desc&limit=20', {
          headers: {
            'apikey': ANON_KEY,
            'Authorization': 'Bearer ' + ANON_KEY,
          },
          priority: 'high'
        }).then(r => r.json()).then(data => {
          window.__PREFETCHED_DATA__.deals = data;
        }).catch(() => {});
        
        // Prefetch neighborhoods
        fetch(SUPABASE_URL + '/rest/v1/neighborhoods?active=eq.true&select=*', {
          headers: {
            'apikey': ANON_KEY,
            'Authorization': 'Bearer ' + ANON_KEY,
          },
          priority: 'low'
        }).then(r => r.json()).then(data => {
          window.__PREFETCHED_DATA__.neighborhoods = data;
        }).catch(() => {});
      })();
    </script>
    
    
    <!-- Preload LCP image with high priority -->
    <link rel="preload" href="/src/assets/jet-logo-256.webp" as="image" type="image/webp" fetchpriority="high">
    <!-- Preload above-fold images -->
    <link rel="preload" href="/pwa-192x192.png" as="image" type="image/png">
    
    <!-- Preload critical CSS bundle -->
    <link rel="modulepreload" href="/src/main.tsx">
    
    <!-- Defer non-critical Mapbox CSS - load async -->
    <link rel="preload" href="https://api.mapbox.com/mapbox-gl-js/v3.16.0/mapbox-gl.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://api.mapbox.com/mapbox-gl-js/v3.16.0/mapbox-gl.css" rel="stylesheet"></noscript>
    
    <!-- Fonts with display=swap for better LCP -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600&display=swap" rel="stylesheet"></noscript>
    
    <title>JET - Discover Whats Hot Right Now</title>
    <meta name="description" content="Find trending venues, live events, and exclusive deals in your area with real-time heatmaps. Your guide to what's happening now in your area.">
    <meta name="author" content="JET Charlotte" />
    <meta name="keywords" content="Charlotte nightlife, CLT events, Charlotte bars, restaurants near me, things to do Charlotte, South End, NoDa, Plaza Midwood">
    
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://storage.googleapis.com/gpt-engineer-file-uploads/VEstUAuq09PlUHZ9f7uy5tQrH263/social-images/social-1765238908620-8.png">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@Lovable" />
    <meta name="twitter:image" content="https://storage.googleapis.com/gpt-engineer-file-uploads/VEstUAuq09PlUHZ9f7uy5tQrH263/social-images/social-1765238908620-8.png">
    
    
    
    
    
    <meta property="og:title" content="JET - Discover Whats Hot Right Now">
  <meta name="twitter:title" content="JET - Discover Whats Hot Right Now">
  <meta property="og:description" content="Find trending venues, live events, and exclusive deals in your area with real-time heatmaps. Your guide to what&#39;s happening now in your area.">
  <meta name="twitter:description" content="Find trending venues, live events, and exclusive deals in your area with real-time heatmaps. Your guide to what&#39;s happening now in your area.">
</head>

  <body style="background-color: #ffffff; margin: 0; padding: 0;">
    <script>
      // Immediately set correct background based on system preference
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.style.backgroundColor = '#0f0f0f';
        document.documentElement.style.backgroundColor = '#0f0f0f';
      }
    </script>
    <!-- Skip to main content link for keyboard users -->
    <a href="#main-content" class="skip-link" style="
      position: absolute;
      left: -9999px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
      z-index: 9999;
    ">Skip to main content</a>
    <style>
      .skip-link:focus {
        position: fixed;
        top: 10px;
        left: 10px;
        width: auto;
        height: auto;
        padding: 12px 24px;
        background: var(--boot-bg);
        color: var(--boot-fg);
        border: 2px solid var(--boot-fg);
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        z-index: 9999;
      }
    </style>
    <!-- Main landmark wrapper - persists after React hydration for accessibility -->
    <main role="main" id="main-content" aria-label="Main content" style="background-color: #ffffff; min-height: 100vh;">
      <script>
        // Set main background immediately
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.currentScript.parentElement.style.backgroundColor = '#0f0f0f';
        }
      </script>
      <div id="root" style="background-color: inherit; min-height: 100vh;">
        <!-- Initial loader - shows before React hydrates -->
        <div id="initial-loader" role="status" aria-live="polite" aria-label="Loading application" style="
          display: flex;
          align-items: center;
          justify-content: center;
          min-height: 100vh;
          min-height: 100dvh;
          background-color: #ffffff;
          flex-direction: column;
          gap: 1rem;
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          z-index: 9999;
          transition: opacity 0.3s ease-out;
        ">
          <div style="
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255, 140, 51, 0.15) 0%, rgba(236, 72, 153, 0.1) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
          " aria-hidden="true">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ff8c33" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(-45deg);" aria-hidden="true" focusable="false">
              <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"></path>
            </svg>
            <!-- Pulsing ring animation -->
            <div style="
              position: absolute;
              inset: 0;
              border-radius: 50%;
              border: 2px solid rgba(255, 140, 51, 0.3);
              animation: initial-pulse 1.5s ease-out infinite;
            "></div>
          </div>
          <p id="loader-text" style="
            color: #0b0b0c;
            font-size: 14px;
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            letter-spacing: 0.05em;
          " aria-hidden="true">Loading JET</p>
        </div>
        <script>
          // Update loader colors for dark mode
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            var loader = document.getElementById('initial-loader');
            var loaderText = document.getElementById('loader-text');
            if (loader) loader.style.backgroundColor = '#0f0f0f';
            if (loaderText) loaderText.style.color = '#fafafa';
          }
        </script>
        <style>
          @keyframes initial-pulse {
            0% { transform: scale(1); opacity: 0.5; }
            100% { transform: scale(1.3); opacity: 0; }
          }
          /* Hide class for JS-based removal - works on all browsers */
          #initial-loader.hidden {
            opacity: 0;
            pointer-events: none;
          }
        </style>
      </div>
      <!-- Script to remove loader once React mounts - more reliable than CSS :has() -->
      <script>
        (function() {
          var loader = document.getElementById('initial-loader');
          if (!loader) return;
          
          // Watch for React to mount content
          var observer = new MutationObserver(function(mutations) {
            var root = document.getElementById('root');
            // Check if React has mounted (root has children other than loader)
            if (root && root.children.length > 1) {
              loader.classList.add('hidden');
              // Remove from DOM after transition
              setTimeout(function() {
                if (loader.parentNode) {
                  loader.parentNode.removeChild(loader);
                }
              }, 350);
              observer.disconnect();
            }
          });
          
          observer.observe(document.getElementById('root'), { 
            childList: true, 
            subtree: false 
          });
          
          // Fallback: remove loader after 10 seconds max to prevent infinite loading
          setTimeout(function() {
            if (loader.parentNode) {
              loader.classList.add('hidden');
              setTimeout(function() {
                if (loader.parentNode) {
                  loader.parentNode.removeChild(loader);
                }
              }, 350);
            }
            observer.disconnect();
          }, 10000);
        })();
      </script>
    </main>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
