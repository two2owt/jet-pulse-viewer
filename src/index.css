@tailwind base;
@tailwind components;
@tailwind utilities;

/* 
 * Force font-display: swap for all Kanit font weights
 * This prevents FOIT (Flash of Invisible Text) by showing fallback font immediately
 * while Kanit loads in the background
 */
/* @fontsource handles font-face declarations via CSS imports in main.tsx */
/* Removed duplicate @font-face rules that had stale hashed file paths */

/* 
 * Fallback font metrics calibrated to match Kanit dimensions exactly
 * This prevents Cumulative Layout Shift (CLS) during font swap
 * Metrics: ascent-override, descent-override, line-gap-override, size-adjust
 * These values were calculated to match Kanit's character bounding boxes
 */
@font-face {
  font-family: 'Kanit Fallback';
  src: local('Arial'), local('Helvetica Neue'), local('Helvetica'), local('sans-serif');
  font-display: swap;
  ascent-override: 105%;
  descent-override: 35%;
  line-gap-override: 0%;
  size-adjust: 97%;
}

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Safe area insets for notched devices - with fallbacks for all browsers */
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);
    
    /* Header and bottom nav heights - centralized for consistency */
    --header-height: 52px;
    --bottom-nav-height: 60px;
    --header-total-height: calc(var(--header-height) + var(--safe-area-inset-top));
    --bottom-nav-total-height: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
    /* Main content area height - MUST match index.html shell exactly */
    --main-height: calc(100dvh - var(--header-total-height) - var(--bottom-nav-total-height));
    
    /* Adaptive map UI spacing - device-aware with safe area consideration */
    /* For absolute positioned elements inside map container */
    --map-ui-inset-top: 0.75rem;
    --map-ui-inset-right: 0.75rem;
    --map-ui-inset-bottom: 0.75rem;
    --map-ui-inset-left: 0.75rem;
    
    /* For fixed positioned elements that need to clear bottom nav */
    --map-fixed-bottom: calc(var(--bottom-nav-total-height) + 0.75rem);
    
    /* Map control panel max width for responsive layouts */
    --map-control-max-width: 140px;
    
    /* Touch-friendly sizing for mobile controls - based on device specs */
    --touch-target-min: 44px;
    --touch-target-comfortable: 48px;
    --control-compact-padding: 0.5rem;
    
    /* Venue marker sizing - adapts to device pixel ratio */
    --venue-marker-base: clamp(28px, 8vw, 40px);
    --venue-marker-active: clamp(32px, 9vw, 48px);
    --venue-marker-icon: clamp(14px, 4vw, 20px);
    
    /* Map button sizing for touch targets */
    --map-btn-sm: clamp(32px, 8vw, 36px);
    --map-btn-md: clamp(36px, 9vw, 44px);
    --map-btn-lg: clamp(44px, 11vw, 52px);
    
    /* Fluid spacing system - adapts to viewport */
    --space-xs: clamp(0.25rem, 0.5vw, 0.5rem);
    --space-sm: clamp(0.5rem, 1vw, 0.75rem);
    --space-md: clamp(0.75rem, 1.5vw, 1rem);
    --space-lg: clamp(1rem, 2vw, 1.5rem);
    --space-xl: clamp(1.5rem, 3vw, 2rem);
    --space-2xl: clamp(2rem, 4vw, 3rem);
    
    /* Dynamic font sizes */
    --text-xs: clamp(0.625rem, 1.5vw, 0.75rem);
    --text-sm: clamp(0.75rem, 2vw, 0.875rem);
    --text-base: clamp(0.875rem, 2.5vw, 1rem);
    --text-lg: clamp(1rem, 3vw, 1.125rem);
    --text-xl: clamp(1.125rem, 3.5vw, 1.25rem);
    --text-2xl: clamp(1.25rem, 4vw, 1.5rem);
    --text-3xl: clamp(1.5rem, 5vw, 1.875rem);
  
    /* Light mode colors - high contrast for visibility */
    --background: 0 0% 98%;
    --foreground: 0 0% 10%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 10%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 10%;

    --primary: 24 100% 50%;
    --primary-foreground: 0 0% 100%;
    --primary-glow: 320 80% 55%;

    --secondary: 0 0% 92%;
    --secondary-foreground: 0 0% 15%;

    --muted: 0 0% 94%;
    --muted-foreground: 0 0% 40%;

    --accent: 320 80% 55%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 50%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 85%;
    --input: 0 0% 92%;
    --ring: 24 100% 50%;

    --hot: 0 85% 50%;
    --warm: 45 100% 45%;
    --cool: 210 100% 45%;
    --cold: 0 0% 60%;

    --gradient-hot: linear-gradient(135deg, hsl(0 85% 50%), hsl(0 85% 40%));
    --gradient-warm: linear-gradient(135deg, hsl(45 100% 50%), hsl(35 100% 45%));
    --gradient-cool: linear-gradient(135deg, hsl(210 100% 50%), hsl(220 100% 40%));
    --gradient-primary: linear-gradient(135deg, hsl(24 100% 50%), hsl(320 80% 55%));
    --gradient-jet: linear-gradient(135deg, hsl(0 0% 95%), hsl(0 0% 90%));
    
    --shadow-glow: 0 0 45px hsl(24 100% 50% / 0.25);
    --shadow-card: 0 15px 40px -15px hsl(0 0% 0% / 0.15);
    --shadow-jet: 0 8px 32px hsl(320 80% 55% / 0.15);
    
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-jet: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);

    --radius: 1rem;

    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 0 0% 10%;
    --sidebar-primary: 24 100% 50%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 0 0% 94%;
    --sidebar-accent-foreground: 0 0% 15%;
    --sidebar-border: 0 0% 85%;
    --sidebar-ring: 24 100% 50%;
  }

  .dark {
    --background: 0 0% 6%;
    --foreground: 0 0% 98%;

    --card: 0 0% 10%;
    --card-foreground: 0 0% 98%;

    --popover: 0 0% 10%;
    --popover-foreground: 0 0% 98%;

    --primary: 24 100% 60%;
    --primary-foreground: 0 0% 100%;
    --primary-glow: 320 80% 65%;

    --secondary: 0 0% 17%;
    --secondary-foreground: 0 0% 95%;

    --muted: 0 0% 17%;
    --muted-foreground: 0 0% 65%;

    --accent: 320 80% 65%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 20%;
    --input: 0 0% 17%;
    --ring: 24 100% 60%;

    --shadow-card: 0 15px 40px -15px hsl(0 0% 0% / 0.7);
  }

  .light {
    --background: 0 0% 98%;
    --foreground: 0 0% 6%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 6%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 6%;

    --primary: 24 100% 50%;
    --primary-foreground: 0 0% 100%;
    --primary-glow: 320 80% 55%;

    --secondary: 0 0% 92%;
    --secondary-foreground: 0 0% 10%;

    --muted: 0 0% 95%;
    --muted-foreground: 0 0% 40%;

    --accent: 320 80% 55%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 50%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 88%;
    --input: 0 0% 92%;
    --ring: 24 100% 50%;

    --hot: 0 85% 50%;
    --warm: 45 100% 50%;
    --cool: 210 100% 50%;
    --cold: 0 0% 70%;

    --gradient-hot: linear-gradient(135deg, hsl(0 85% 50%), hsl(0 85% 40%));
    --gradient-warm: linear-gradient(135deg, hsl(45 100% 50%), hsl(35 100% 45%));
    --gradient-cool: linear-gradient(135deg, hsl(210 100% 50%), hsl(220 100% 40%));
    --gradient-primary: linear-gradient(135deg, hsl(24 100% 50%), hsl(320 80% 55%));
    --gradient-jet: linear-gradient(135deg, hsl(0 0% 98%), hsl(0 0% 92%));
    
    --shadow-glow: 0 0 45px hsl(24 100% 50% / 0.25);
    --shadow-card: 0 8px 24px -8px hsl(0 0% 0% / 0.15);
    --shadow-jet: 0 8px 32px hsl(320 80% 55% / 0.15);

    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 0 0% 6%;
    --sidebar-primary: 24 100% 50%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 0 0% 92%;
    --sidebar-accent-foreground: 0 0% 10%;
    --sidebar-border: 0 0% 88%;
    --sidebar-ring: 24 100% 50%;
  }
}

/* Ultra-small mobile devices (iPhone SE, small Android phones) */
@media (max-width: 375px) {
  :root {
    --header-height: 48px;
    --bottom-nav-height: 56px;
    --map-ui-inset-top: 0.5rem;
    --map-ui-inset-right: 0.5rem;
    --map-ui-inset-bottom: 0.5rem;
    --map-ui-inset-left: 0.5rem;
    --map-fixed-bottom: calc(var(--bottom-nav-total-height) + 0.5rem);
    --map-control-max-width: 120px;
    --venue-marker-base: 26px;
    --venue-marker-active: 30px;
    --venue-marker-icon: 12px;
    --map-btn-sm: 28px;
    --map-btn-md: 32px;
  }
}

/* Standard mobile phones */
@media (min-width: 376px) and (max-width: 639px) {
  :root {
    --header-height: 52px;
    --bottom-nav-height: 60px;
    --map-ui-inset-top: 0.75rem;
    --map-ui-inset-right: 0.75rem;
    --map-ui-inset-bottom: 0.75rem;
    --map-ui-inset-left: 0.75rem;
    --map-fixed-bottom: calc(var(--bottom-nav-total-height) + 0.75rem);
    --map-control-max-width: 140px;
  }
}

/* Responsive map UI spacing - tablet */
@media (min-width: 640px) {
  :root {
    --header-height: 56px;
    --bottom-nav-height: 64px;
    --map-ui-inset-top: 1rem;
    --map-ui-inset-right: 1rem;
    --map-ui-inset-bottom: 1rem;
    --map-ui-inset-left: 1rem;
    --map-fixed-bottom: calc(var(--bottom-nav-total-height) + 1rem);
    --map-control-max-width: 180px;
    --venue-marker-base: 36px;
    --venue-marker-active: 44px;
    --venue-marker-icon: 18px;
    --map-btn-sm: 36px;
    --map-btn-md: 42px;
  }
}

/* Responsive map UI spacing - tablet landscape / small desktop */
@media (min-width: 768px) {
  :root {
    --header-height: 60px;
    --bottom-nav-height: 68px;
    --map-ui-inset-top: 1.25rem;
    --map-ui-inset-right: 1.25rem;
    --map-ui-inset-bottom: 1.25rem;
    --map-ui-inset-left: 1.25rem;
    --map-fixed-bottom: calc(var(--bottom-nav-total-height) + 1.25rem);
    --map-control-max-width: 220px;
    --venue-marker-base: 40px;
    --venue-marker-active: 48px;
    --venue-marker-icon: 20px;
  }
}

/* Responsive map UI spacing - desktop */
@media (min-width: 1024px) {
  :root {
    --header-height: 64px;
    --bottom-nav-height: 72px;
    --map-ui-inset-top: 1.5rem;
    --map-ui-inset-right: 1.5rem;
    --map-ui-inset-bottom: 1.5rem;
    --map-ui-inset-left: 1.5rem;
    --map-fixed-bottom: calc(var(--bottom-nav-total-height) + 1.5rem);
    --map-control-max-width: 260px;
  }
}

/* Large desktop */
@media (min-width: 1280px) {
  :root {
    --map-control-max-width: 320px;
    --venue-marker-base: 44px;
    --venue-marker-active: 52px;
  }
}

@layer base {
  * {
    @apply border-border;
    box-sizing: border-box;
  }

  html {
    overflow-x: hidden;
    width: 100%;
    max-width: 100vw;
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    /* Force consistent viewport on all visits */
    height: 100%;
    min-height: 100%;
  }

  body {
    @apply bg-background text-foreground font-sans;
    overflow-x: hidden;
    overflow-y: hidden; /* Prevent body scroll - app handles its own scrolling */
    width: 100%;
    max-width: 100vw;
    min-height: 100vh;
    min-height: 100dvh;
    height: 100dvh;
    touch-action: pan-y pinch-zoom;
    -webkit-overflow-scrolling: touch;
    /* DO NOT add padding for safe areas here - components handle it */
    margin: 0;
    padding: 0;
    /* Prevent layout shift on session restore */
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
  }
  
  #root {
    width: 100%;
    max-width: 100vw;
    min-height: 100dvh;
    height: 100dvh;
    overflow: hidden; /* Root doesn't scroll - inner content does */
    -webkit-overflow-scrolling: touch;
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    /* Match body layout */
    display: flex;
    flex-direction: column;
    flex: 1;
    position: relative;
  }

  /* App wrapper - ensures consistent layout on all visits including session restore */
  .app-wrapper {
    display: flex;
    flex-direction: column;
    min-height: 100dvh;
    height: 100dvh;
    width: 100%;
    max-width: 100vw;
    position: relative;
    flex: 1;
    background-color: hsl(var(--background));
    /* Strict containment - prevents all layout recalculations from affecting parent */
    contain: strict;
    overflow: hidden;
    /* Force GPU layer to prevent repaints causing shifts */
    transform: translateZ(0);
    /* Explicit sizing prevents browser recalculation */
    box-sizing: border-box;
    /* Create isolated stacking context to prevent shift propagation */
    isolation: isolate;
  }
  
  /* Prevent pseudo-element animations from causing layout shifts in app-wrapper only */
  .app-wrapper::before,
  .app-wrapper::after {
    contain: strict;
    position: absolute;
    pointer-events: none;
    /* Ensure they don't contribute to layout */
    width: 0;
    height: 0;
  }

  /* Main content area - consistent across all pages */
  .main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 100vw;
    position: relative;
    overflow: hidden;
    /* Fade-in animation for smooth content transitions */
    animation: content-fade-in 0.3s ease-out forwards;
    /* CSS containment for performance */
    contain: layout style;
  }
  
  /* Content fade-in animation keyframes - opacity only for CLS safety */
  /* Transform animations on page content can cause layout shifts during hydration */
  @keyframes content-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  /* Page content fade-in class for route transitions - opacity only */
  .page-fade-in {
    animation: content-fade-in 0.25s ease-out forwards;
  }

  /* Page container with bottom nav clearance and scrolling */
  .page-container {
    flex: 1;
    width: 100%;
    max-width: 100vw;
    /* Use CSS variable for consistent bottom clearance */
    padding-bottom: var(--bottom-nav-total-height);
    overflow-x: hidden;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    /* CSS containment */
    contain: layout style;
    height: auto;
    min-height: var(--main-height);
  }

  /* Map page container - no scroll, full height with strict containment */
  .map-container {
    /* Fixed dimensions to prevent layout shift - use 100% to match parent */
    height: 100% !important;
    min-height: 100% !important;
    max-height: 100% !important;
    width: 100% !important;
    max-width: 100% !important;
    overflow: hidden !important;
    position: absolute;
    inset: 0;
    /* Strict containment for map - prevents all layout recalculations */
    contain: strict;
    /* Force GPU layer to prevent repaints causing shifts */
    transform: translateZ(0);
    /* Create isolated stacking context */
    isolation: isolate;
    /* Explicit content-visibility for performance */
    content-visibility: auto;
    /* Match parent intrinsic size instead of fixed viewport */
    contain-intrinsic-size: auto;
  }

  /* Map wrapper - isolates map from parent layout changes */
  .map-wrapper {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    /* Strict containment for the actual map element */
    contain: strict;
    /* Create new stacking context */
    isolation: isolate;
    /* GPU acceleration */
    transform: translateZ(0);
    will-change: contents;
  }

  /* Card containment - prevents card updates from affecting layout */
  .card-contained {
    contain: layout style paint;
  }

  /* Header containment - prevents header updates from affecting body */
  /* Uses 'layout paint' instead of 'layout style' to preserve color inheritance for SVG icons */
  .header-contained {
    contain: layout paint;
    /* Ensure text color is inherited for SVG currentColor */
    color: inherit;
  }

  /* Bottom nav containment */
  /* Uses 'layout paint' instead of strict to preserve color inheritance for SVG icons */
  .nav-contained {
    contain: layout paint;
    /* Ensure text color is inherited for SVG currentColor */
    color: inherit;
  }
}

@layer utilities {
  /* Touch target utilities - ensures minimum 44px touch area for accessibility */
  .touch-target {
    min-width: 44px;
    min-height: 44px;
  }
  
  .touch-target-sm {
    min-width: 36px;
    min-height: 36px;
  }
  
  .touch-target-lg {
    min-width: 48px;
    min-height: 48px;
  }

  /* Safe area spacing utilities */
  .safe-area-top {
    padding-top: var(--safe-area-inset-top);
  }
  
  .safe-area-bottom {
    padding-bottom: var(--safe-area-inset-bottom);
  }
  
  .safe-area-left {
    padding-left: var(--safe-area-inset-left);
  }
  
  .safe-area-right {
    padding-right: var(--safe-area-inset-right);
  }
  
  .safe-area-inset {
    padding-top: var(--safe-area-inset-top);
    padding-right: var(--safe-area-inset-right);
    padding-bottom: var(--safe-area-inset-bottom);
    padding-left: var(--safe-area-inset-left);
  }
  
  /* Fluid spacing utilities */
  .space-fluid-xs { padding: var(--space-xs); }
  .space-fluid-sm { padding: var(--space-sm); }
  .space-fluid-md { padding: var(--space-md); }
  .space-fluid-lg { padding: var(--space-lg); }
  .space-fluid-xl { padding: var(--space-xl); }
  .space-fluid-2xl { padding: var(--space-2xl); }
  
  .px-fluid-xs { padding-left: var(--space-xs); padding-right: var(--space-xs); }
  .px-fluid-sm { padding-left: var(--space-sm); padding-right: var(--space-sm); }
  .px-fluid-md { padding-left: var(--space-md); padding-right: var(--space-md); }
  .px-fluid-lg { padding-left: var(--space-lg); padding-right: var(--space-lg); }
  .px-fluid-xl { padding-left: var(--space-xl); padding-right: var(--space-xl); }
  
  .py-fluid-xs { padding-top: var(--space-xs); padding-bottom: var(--space-xs); }
  .py-fluid-sm { padding-top: var(--space-sm); padding-bottom: var(--space-sm); }
  .py-fluid-md { padding-top: var(--space-md); padding-bottom: var(--space-md); }
  .py-fluid-lg { padding-top: var(--space-lg); padding-bottom: var(--space-lg); }
  .py-fluid-xl { padding-top: var(--space-xl); padding-bottom: var(--space-xl); }
  
  .gap-fluid-xs { gap: var(--space-xs); }
  .gap-fluid-sm { gap: var(--space-sm); }
  .gap-fluid-md { gap: var(--space-md); }
  .gap-fluid-lg { gap: var(--space-lg); }
  .gap-fluid-xl { gap: var(--space-xl); }
  
  /* Responsive text sizing */
  .text-fluid-xs { font-size: var(--text-xs); }
  .text-fluid-sm { font-size: var(--text-sm); }
  .text-fluid-base { font-size: var(--text-base); }
  .text-fluid-lg { font-size: var(--text-lg); }
  .text-fluid-xl { font-size: var(--text-xl); }
  .text-fluid-2xl { font-size: var(--text-2xl); }
  .text-fluid-3xl { font-size: var(--text-3xl); }
}

/* Note: Primary responsive map UI insets are defined earlier in the file */

@layer utilities {
  .pulse-glow {
    animation: pulse-glow 2s ease-in-out infinite;
  }
  
  @keyframes pulse-glow {
    0%, 100% {
      opacity: 1;
      transform: scale(1);
    }
    50% {
      opacity: 0.7;
      transform: scale(1.1);
    }
  }

  /* Shimmer loading animation for skeletons */
  .animate-shimmer {
    animation: shimmer 1.5s ease-in-out infinite;
    background: linear-gradient(
      90deg,
      hsl(var(--card)) 0%,
      hsl(var(--muted)) 50%,
      hsl(var(--card)) 100%
    );
    background-size: 200% 100%;
  }

  /* Static skeleton placeholder - animations removed for initial load performance */
  .shimmer-skeleton {
    position: relative;
    overflow: hidden;
    background: hsl(var(--muted) / 0.5);
  }

  /* Venue marker pulsating animations */
  @keyframes venue-pulse-intense {
    0%, 100% {
      transform: rotate(-45deg) scale(1);
      box-shadow: 
        0 8px 32px currentColor,
        0 0 0 1px rgba(255, 255, 255, 0.1),
        0 0 60px currentColor,
        inset 0 1px 2px rgba(255, 255, 255, 0.4);
    }
    50% {
      transform: rotate(-45deg) scale(1.15);
      box-shadow: 
        0 12px 48px currentColor,
        0 0 0 2px rgba(255, 255, 255, 0.3),
        0 0 80px currentColor,
        inset 0 2px 3px rgba(255, 255, 255, 0.5);
    }
  }

  @keyframes venue-pulse-moderate {
    0%, 100% {
      transform: rotate(-45deg) scale(1);
      box-shadow: 
        0 8px 32px currentColor,
        0 0 0 1px rgba(255, 255, 255, 0.1),
        0 0 40px currentColor,
        inset 0 1px 2px rgba(255, 255, 255, 0.4);
    }
    50% {
      transform: rotate(-45deg) scale(1.1);
      box-shadow: 
        0 10px 40px currentColor,
        0 0 0 1.5px rgba(255, 255, 255, 0.2),
        0 0 50px currentColor,
        inset 0 1.5px 2.5px rgba(255, 255, 255, 0.45);
    }
  }

  @keyframes venue-pulse-subtle {
    0%, 100% {
      transform: rotate(-45deg) scale(1);
      opacity: 0.95;
    }
    50% {
      transform: rotate(-45deg) scale(1.05);
      opacity: 1;
    }
  }

  @keyframes bounce {
    0%, 100% {
      transform: rotate(-45deg) translateY(0);
    }
    25% {
      transform: rotate(-45deg) translateY(-10px);
    }
    50% {
      transform: rotate(-45deg) translateY(-5px);
    }
    75% {
      transform: rotate(-45deg) translateY(-7px);
    }
  }

  @keyframes gradient-shift {
    0%, 100% {
      background: linear-gradient(
        135deg,
        rgba(0, 0, 0, 0.35) 0%,
        rgba(10, 10, 15, 0.30) 25%,
        rgba(0, 0, 0, 0.35) 50%,
        rgba(10, 10, 15, 0.32) 75%,
        rgba(0, 0, 0, 0.35) 100%
      );
    }
    25% {
      background: linear-gradient(
        135deg,
        rgba(10, 10, 15, 0.32) 0%,
        rgba(0, 0, 0, 0.35) 25%,
        rgba(10, 10, 15, 0.30) 50%,
        rgba(0, 0, 0, 0.35) 75%,
        rgba(10, 10, 15, 0.32) 100%
      );
    }
    50% {
      background: linear-gradient(
        135deg,
        rgba(10, 10, 15, 0.30) 0%,
        rgba(10, 10, 15, 0.32) 25%,
        rgba(0, 0, 0, 0.35) 50%,
        rgba(10, 10, 15, 0.30) 75%,
        rgba(0, 0, 0, 0.35) 100%
      );
    }
    75% {
      background: linear-gradient(
        135deg,
        rgba(0, 0, 0, 0.35) 0%,
        rgba(10, 10, 15, 0.30) 25%,
        rgba(10, 10, 15, 0.32) 50%,
        rgba(0, 0, 0, 0.35) 75%,
        rgba(10, 10, 15, 0.30) 100%
      );
    }
  }

  .auth-gradient-overlay {
    animation: gradient-shift 12s ease-in-out infinite;
  }

  /* Disable animations for reduced motion preference or low power mode */
  @media (prefers-reduced-motion: reduce) {
    .auth-gradient-overlay {
      animation: none;
    }
  }

  .glow-subtle {
    box-shadow: 0 0 20px hsl(var(--primary) / 0.2);
    transition: box-shadow 0.3s ease-in-out;
  }

  .glow-subtle:hover {
    box-shadow: 0 0 30px hsl(var(--primary) / 0.4);
  }

  .glow-button {
    box-shadow: 0 0 15px hsl(var(--primary) / 0.3);
    transition: all 0.3s ease-in-out;
  }

  .glow-button:hover {
    box-shadow: 0 0 25px hsl(var(--primary) / 0.5);
  }
  
  /* Deal marker animations - removed */

  /* Mobile map controls - responsive based on device */
  .mapboxgl-ctrl-group {
    border-radius: 8px !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
    overflow: hidden;
  }
  
  .mapboxgl-ctrl-group button {
    width: var(--map-btn-md) !important;
    height: var(--map-btn-md) !important;
  }
  
  .mapboxgl-ctrl-geolocate {
    width: var(--map-btn-md) !important;
    height: var(--map-btn-md) !important;
  }
  
  /* Ultra-small screens (iPhone SE, small Android) */
  @media (max-width: 360px) {
    .mapboxgl-ctrl-group {
      transform: scale(0.85);
      transform-origin: top right;
    }
    
    .mapboxgl-ctrl-group button {
      width: 28px !important;
      height: 28px !important;
    }
  }
  
  /* Small mobile (most phones) */
  @media (min-width: 361px) and (max-width: 480px) {
    .mapboxgl-ctrl-group button {
      width: 32px !important;
      height: 32px !important;
    }
  }
  
  /* Large phones and phablets */
  @media (min-width: 481px) and (max-width: 640px) {
    .mapboxgl-ctrl-group button {
      width: 36px !important;
      height: 36px !important;
    }
  }
  
  /* Tablets */
  @media (min-width: 641px) and (max-width: 1024px) {
    .mapboxgl-ctrl-group button {
      width: 40px !important;
      height: 40px !important;
    }
  }
  
  /* Desktop */
  @media (min-width: 1025px) {
    .mapboxgl-ctrl-group button {
      width: 44px !important;
      height: 44px !important;
    }
  }
  
  /* High DPI displays - ensure crisp rendering */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .mapboxgl-ctrl-group {
      border-width: 0.5px !important;
    }
  }

  /* Touch-friendly timelapse swipe control */
  .timelapse-swipe-control {
    touch-action: pan-x;
    user-select: none;
    -webkit-user-select: none;
  }

  .timelapse-touch-button {
    @apply flex items-center justify-center w-8 h-8 rounded-full text-muted-foreground transition-colors;
    @apply hover:bg-muted/50 hover:text-foreground active:bg-primary/20 active:text-primary;
    @apply disabled:opacity-50 disabled:pointer-events-none;
    min-width: 32px;
    min-height: 32px;
  }

  /* Compact control panel styles for mobile */
  .map-control-compact {
    @apply bg-card/90 backdrop-blur-lg rounded-lg border border-border/50 shadow-md;
    padding: var(--control-compact-padding, 0.375rem);
    /* Ensure visibility on mobile */
    will-change: transform, opacity;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  /* Mobile-specific control panel adjustments */
  @media (max-width: 640px) {
    .map-control-compact {
      max-width: 160px !important;
      font-size: 10px !important;
      padding: 0.25rem;
    }
    
    .map-control-compact select,
    .map-control-compact button {
      min-height: 26px !important;
      font-size: 9px !important;
    }
  }

  .map-control-compact .control-header {
    @apply flex items-center justify-between text-[10px] font-medium text-muted-foreground mb-1;
  }

  /* Path flow compact slider - orange themed */
  .path-flow-slider {
    @apply w-full appearance-none bg-transparent cursor-pointer;
    height: 20px;
  }

  .path-flow-slider::-webkit-slider-runnable-track {
    @apply w-full rounded-full;
    height: 6px;
    background: linear-gradient(to right, hsl(var(--primary) / 0.3), hsl(var(--primary) / 0.5));
    border: 1px solid hsl(var(--primary) / 0.3);
  }

  .path-flow-slider::-webkit-slider-thumb {
    @apply appearance-none rounded-full shadow-lg;
    width: 16px;
    height: 16px;
    background: hsl(var(--primary));
    border: 2px solid hsl(var(--background));
    box-shadow: 0 0 8px hsl(var(--primary) / 0.5);
    margin-top: -6px;
    transform: translateY(0.5px);
  }

  .path-flow-slider::-webkit-slider-thumb:hover {
    box-shadow: 0 0 12px hsl(var(--primary) / 0.7);
    transform: translateY(0.5px) scale(1.1);
  }

  .path-flow-slider::-moz-range-track {
    @apply w-full rounded-full;
    height: 6px;
    background: linear-gradient(to right, hsl(var(--primary) / 0.3), hsl(var(--primary) / 0.5));
    border: 1px solid hsl(var(--primary) / 0.3);
  }

  .path-flow-slider::-moz-range-thumb {
    @apply rounded-full;
    width: 16px;
    height: 16px;
    background: hsl(var(--primary));
    border: 2px solid hsl(var(--background));
    box-shadow: 0 0 8px hsl(var(--primary) / 0.5);
  }

  .path-flow-slider::-moz-range-thumb:hover {
    box-shadow: 0 0 12px hsl(var(--primary) / 0.7);
  }

  /* Compact control inline row */
  .control-inline-row {
    @apply flex items-center gap-1.5 text-[10px];
  }

  .control-inline-label {
    @apply text-muted-foreground whitespace-nowrap min-w-[40px];
  }

  .control-inline-value {
    @apply font-medium text-foreground;
  }

  /* Map controls toggle button */
  .map-controls-toggle {
    @apply bg-card/95 backdrop-blur-xl rounded-full p-2 border border-border shadow-lg;
    @apply transition-all duration-300 hover:bg-card hover:scale-105;
    @apply focus:outline-none focus:ring-2 focus:ring-primary/50;
  }

  .map-controls-toggle:active {
    @apply scale-95;
  }

  /* Collapsed state indicator */
  .map-controls-collapsed-hint {
    @apply absolute bottom-0 right-0 w-1 h-8 bg-primary/50 rounded-full;
    animation: pulse-hint 2s ease-in-out infinite;
  }

  @keyframes pulse-hint {
    0%, 100% {
      opacity: 0.3;
    }
    50% {
      opacity: 0.7;
    }
  }

  /* Cloud/fog flying through animation for sync indicator */
  @keyframes cloud-drift-left {
    0% {
      transform: translateX(100%);
      opacity: 0;
    }
    10% {
      opacity: 0.8;
    }
    90% {
      opacity: 0.8;
    }
    100% {
      transform: translateX(-100%);
      opacity: 0;
    }
  }

  @keyframes cloud-drift-right {
    0% {
      transform: translateX(-100%);
      opacity: 0;
    }
    10% {
      opacity: 0.6;
    }
    90% {
      opacity: 0.6;
    }
    100% {
      transform: translateX(100%);
      opacity: 0;
    }
  }

  @keyframes airplane-fly {
    0% {
      transform: translateX(-20px) translateY(2px) rotate(-5deg);
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    25% {
      transform: translateX(0) translateY(-2px) rotate(0deg);
    }
    50% {
      transform: translateX(10px) translateY(1px) rotate(3deg);
    }
    75% {
      transform: translateX(5px) translateY(-1px) rotate(-2deg);
    }
    90% {
      opacity: 1;
    }
    100% {
      transform: translateX(-20px) translateY(2px) rotate(-5deg);
      opacity: 0;
    }
  }

  @keyframes airplane-bob {
    0%, 100% {
      transform: translateY(0) rotate(0deg);
    }
    25% {
      transform: translateY(-2px) rotate(2deg);
    }
    50% {
      transform: translateY(1px) rotate(-1deg);
    }
    75% {
      transform: translateY(-1px) rotate(1deg);
    }
  }

  .sync-airplane-wrapper {
    animation: airplane-fly 2.5s ease-in-out infinite;
  }

  .sync-airplane {
    animation: airplane-bob 1s ease-in-out infinite;
    filter: drop-shadow(0 2px 4px hsl(var(--primary) / 0.6));
  }

  /* Duplicate airplane-fly keyframe removed - using version at line 1016 */

  .sync-cloud-bg {
    animation: cloud-bg-drift 3s ease-in-out infinite;
  }

  .sync-cloud-bg-2 {
    animation: cloud-bg-drift 3.5s ease-in-out infinite reverse;
  }

  @keyframes cloud-bg-drift {
    0%, 100% {
      transform: translateX(0) scale(1);
      opacity: 0.4;
    }
    50% {
      transform: translateX(2px) scale(1.1);
      opacity: 0.6;
    }
  }

  .sync-passing-clouds {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .sync-passing-clouds::before,
  .sync-passing-clouds::after {
    content: '';
    position: absolute;
    width: 40%;
    height: 60%;
    background: radial-gradient(ellipse, hsl(var(--foreground) / 0.15) 0%, transparent 70%);
    border-radius: 50%;
    filter: blur(3px);
    /* CLS-safe: use translateX instead of left for composited animation */
    left: 0;
    animation: passing-cloud 4s linear infinite;
    will-change: transform, opacity;
  }

  .sync-passing-clouds::before {
    top: 20%;
    animation-delay: 0s;
  }

  .sync-passing-clouds::after {
    top: 40%;
    animation-delay: 2s;
  }

  /* CLS-safe: translateX is a composited animation, doesn't trigger re-layout */
  @keyframes passing-cloud {
    0% {
      transform: translateX(250%);
      opacity: 0;
    }
    10% {
      opacity: 0.5;
    }
    90% {
      opacity: 0.5;
    }
    100% {
      transform: translateX(-100%);
      opacity: 0;
    }
  }

  @keyframes contrail-fade {
    0% {
      opacity: 0.8;
      transform: scaleX(0.2) translateX(0);
    }
    50% {
      opacity: 0.5;
    }
    100% {
      opacity: 0;
      transform: scaleX(2) translateX(-10px);
    }
  }

  .sync-contrail {
    position: absolute;
    right: 100%;
    top: 50%;
    height: 1.5px;
    width: 16px;
    background: linear-gradient(90deg, transparent, hsl(var(--primary) / 0.7));
    transform-origin: right center;
    animation: contrail-fade 0.8s ease-out infinite;
    border-radius: 1px;
  }

  .sync-contrail-1 {
    top: 30%;
    animation-delay: 0s;
  }

  .sync-contrail-2 {
    top: 70%;
    animation-delay: 0.15s;
  }

  @keyframes cloud-float {
    0%, 100% {
      transform: translateY(0) scale(1);
      opacity: 0.7;
    }
    50% {
      transform: translateY(-2px) scale(1.05);
      opacity: 0.9;
    }
  }

  @keyframes sync-glow-pulse {
    0%, 100% {
      box-shadow: 0 0 8px hsl(var(--primary) / 0.3);
    }
    50% {
      box-shadow: 0 0 16px hsl(var(--primary) / 0.6);
    }
  }

  .sync-cloud-container {
    position: relative;
    overflow: hidden;
    border-radius: 9999px;
  }

  .sync-cloud-container.syncing {
    animation: sync-glow-pulse 1.5s ease-in-out infinite;
  }

  .sync-cloud {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .sync-cloud::before,
  .sync-cloud::after {
    content: '';
    position: absolute;
    border-radius: 50%;
    filter: blur(4px);
  }

  .sync-cloud::before {
    width: 120%;
    height: 60%;
    top: 20%;
    background: radial-gradient(ellipse, hsl(var(--foreground) / 0.15) 0%, transparent 70%);
    animation: cloud-drift-left 2s ease-in-out infinite;
  }

  .sync-cloud::after {
    width: 80%;
    height: 50%;
    top: 30%;
    background: radial-gradient(ellipse, hsl(var(--foreground) / 0.1) 0%, transparent 60%);
    animation: cloud-drift-right 2.5s ease-in-out infinite 0.3s;
  }

  .sync-cloud-wisps {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .sync-cloud-wisps::before {
    content: '';
    position: absolute;
    width: 60%;
    height: 40%;
    top: 30%;
    left: 20%;
    background: radial-gradient(ellipse, hsl(var(--muted-foreground) / 0.2) 0%, transparent 50%);
    animation: cloud-float 3s ease-in-out infinite;
    filter: blur(3px);
  }

  .sync-success-flash {
    animation: success-flash 0.5s ease-out forwards;
  }

  @keyframes success-flash {
    0% {
      background: hsl(var(--primary) / 0.3);
      transform: scale(1);
    }
    50% {
      background: hsl(142 76% 45% / 0.4);
      transform: scale(1.1);
    }
    100% {
      background: transparent;
      transform: scale(1);
    }
  }


  .runway-landing-flash {
    animation: runway-landing 0.6s ease-out forwards;
  }

  @keyframes runway-landing {
    0% {
      box-shadow: 0 0 0 0 hsl(var(--primary) / 0.4);
    }
    50% {
      box-shadow: 0 0 15px 2px hsl(142 76% 45% / 0.5);
    }
    100% {
      box-shadow: 0 0 0 0 transparent;
    }
  }

  .landed-airplane {
    animation: landed-settle 0.5s ease-out forwards;
  }

  @keyframes landed-settle {
    0% {
      transform: translateX(10px) rotate(-15deg);
      opacity: 0;
    }
    60% {
      transform: translateX(-2px) rotate(-8deg);
    }
    100% {
      transform: translateX(0) rotate(-10deg);
      opacity: 1;
    }
  }

  .arrival-destination {
    animation: arrival-fade-in 0.8s ease-out 0.3s both;
  }

  @keyframes arrival-fade-in {
    0% {
      opacity: 0;
      transform: translateX(8px);
    }
    60% {
      opacity: 1;
    }
    100% {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .arrival-city-name {
    animation: city-slide-in 0.6s ease-out 0.5s both;
  }

  @keyframes city-slide-in {
    0% {
      opacity: 0;
      transform: translateY(4px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Glassmorphic orb pulse animation for venue markers */
  @keyframes orbPulse {
    0% {
      transform: scale(1);
      opacity: 0.6;
    }
    50% {
      transform: scale(1.4);
      opacity: 0;
    }
    100% {
      transform: scale(1.8);
      opacity: 0;
    }
  }

  /* Orb entrance animation - scale up and fade in (no translate to preserve GPS anchor) */
  /* Marker fade in animation - simple opacity transition */
  @keyframes markerFadeIn {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
  
  /* Marker ring pulse animation for activity indication */
  @keyframes markerRingPulse {
    0%, 100% {
      transform: rotate(-45deg) scale(1);
      opacity: var(--ring-opacity, 0.5);
    }
    50% {
      transform: rotate(-45deg) scale(1.15);
      opacity: calc(var(--ring-opacity, 0.5) * 1.5);
    }
  }
  
  /* Orb entrance animation - kept for skeleton loading states */
  /* Unused orb entrance animations removed - skeletons are now static for CLS prevention */
  
  /* Slide in from top animation - GPU accelerated for OfflineBanner */
  @keyframes slideInFromTop {
    0% {
      transform: translateY(-100%);
      opacity: 0;
    }
    100% {
      transform: translateY(0);
      opacity: 1;
    }
  }
}
